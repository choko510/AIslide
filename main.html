<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web Slide Maker - Modern (Enhanced)</title>
    <link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v6.7.2/css/all.css">
    <link rel="stylesheet" href="style.css">
    <!-- Google Fonts: Noto Sans JP を例として追加 -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
</head>

<body>
    <div id="app-container">
        <header id="toolbar">
            <button id="add-slide-btn" title="スライド追加"><i class="fas fa-plus"></i><span>スライド追加</span></button>
            <button id="delete-slide-btn" title="スライド削除"><i class="fas fa-trash-alt"></i><span>スライド削除</span></button>
            <div class="separator"></div>
            <!-- Element add buttons moved to sidebar -->
            <div class="separator"></div>
            <!-- アラインメントボタングループ -->
            <div class="btn-group" role="toolbar" aria-label="Alignment controls">
                <button id="align-left-btn" title="左揃え" aria-label="左揃え"><i class="fas fa-align-left"></i></button>
                <button id="align-center-h-btn" title="水平中央揃え" aria-label="水平中央揃え"><i class="fas fa-align-center"></i></button>
                <button id="align-right-btn" title="右揃え" aria-label="右揃え"><i class="fas fa-align-right"></i></button>
                <button id="align-top-btn" title="上揃え" aria-label="上揃え"><i class="fas fa-align-top"></i></button>
                <button id="align-center-v-btn" title="垂直中央揃え" aria-label="垂直中央揃え"><i class="fas fa-arrows-alt-v"></i></button>
                <button id="align-bottom-btn" title="下揃え" aria-label="下揃え"><i class="fas fa-align-bottom"></i></button>
                <button id="distribute-h-btn" title="水平方向へ等間隔に配置" aria-label="水平方向へ等間隔に配置"><i class="fas fa-grip-lines"></i></button>
                <button id="distribute-v-btn" title="垂直方向へ等間隔に配置" aria-label="垂直方向へ等間隔に配置"><i class="fas fa-grip-lines-vertical"></i></button>
            </div>
            <div class="separator"></div>
            <button id="save-btn" title="保存"><i class="fas fa-save"></i><span>保存</span></button>
            <button id="present-btn" title="プレゼンテーション開始"><i class="fas fa-play"></i><span>開始</span></button>
            <button id="export-btn" title="エクスポート" aria-haspopup="true" aria-expanded="false"><i class="fas fa-download"></i><span>エクスポート</span></button>
            <div id="export-menu" role="menu" aria-labelledby="export-btn" class="export-menu-container">
            </div>
        </header>

        <div id="app-body" class="app-body-container">
            <div id="center-content" class="center-content-container">
                <aside id="left-sidebar" class="left-sidebar-container">
                    <div id="sidebar-tabs" class="sidebar-tabs-container" role="tablist" aria-label="サイドバータブ">
                        <button class="sidebar-tab-button active" data-tab="elements" role="tab" aria-selected="true" aria-controls="elements-panel">素材</button>
                        <button class="sidebar-tab-button" data-tab="icons" role="tab" aria-selected="false" aria-controls="icons-panel">アイコン</button>
                        <button class="sidebar-tab-button" data-tab="inspector" role="tab" aria-selected="false" aria-controls="inspector-panel">設定</button>
                        <button class="sidebar-tab-button" data-tab="chat" role="tab" aria-selected="false" aria-controls="chat-panel-content">AI</button>
                    </div>
                    <div id="sidebar-content" class="sidebar-content-container">
                        <div id="elements-panel" class="sidebar-tab-content active" data-tab-content="elements" role="tabpanel" aria-labelledby="elements-tab">
                            <div id="element-add-buttons-container" class="element-add-buttons-grid">
                                <button id="add-text-btn" class="sidebar-add-btn"><i class="fas fa-font fa-fw"></i><span>テキスト</span></button>
                                <input type="file" id="image-upload-input" accept="image/*" class="image-upload-hidden" aria-label="画像アップロード">
                                <button id="add-image-btn" class="sidebar-add-btn"><i class="fas fa-image fa-fw"></i><span>画像</span></button>
                                <button id="add-video-btn" class="sidebar-add-btn"><i class="fas fa-video fa-fw"></i><span>動画</span></button>
                                <button id="add-table-btn" class="sidebar-add-btn"><i class="fas fa-table fa-fw"></i><span>表</span></button>
                                <button id="add-chart-btn" class="sidebar-add-btn"><i class="fas fa-chart-bar fa-fw"></i><span>グラフ</span></button>
                                <button id="add-iframe-btn" class="sidebar-add-btn"><i class="fas fa-code fa-fw"></i><span>埋め込み</span></button>
                                <button id="add-qr-btn" class="sidebar-add-btn"><i class="fas fa-qrcode fa-fw"></i><span>QRコード</span></button>
                            </div>
                        </div>
                        <div id="icons-panel" class="sidebar-tab-content" data-tab-content="icons" role="tabpanel" aria-labelledby="icons-tab">
                            <div class="icon-toggle-container">
                                <button id="fa-toggle-btn" class="sidebar-add-btn active" aria-pressed="true"><i class="fa-brands fa-font-awesome"></i><span>Font Awesome</span></button>
                                <button id="mi-toggle-btn" class="sidebar-add-btn" aria-pressed="false"><i class="material-icons">star</i><span>Material Icons</span></button>
                            </div>

                            <!-- Font Awesome Section -->
                            <section id="font-awesome-section" aria-labelledby="fa-toggle-btn">
                                <div id="fa-icon-search-toolbar" class="icon-search-toolbar">
                                    <input type="text" id="fa-icon-search-input" placeholder="Font Awesomeアイコン検索..." aria-label="Font Awesomeアイコン検索">
                                </div>
                                <div class="icon-style-selector">
                                    <label for="fa-style-select">スタイル</label>
                                    <select id="fa-style-select">
                                        <option value="fas">Solid</option>
                                        <option value="far">Regular</option>
                                        <option value="fal">Light</option>
                                        <option value="fat">Thin</option>
                                    </select>
                                </div>
                                <div id="fa-icon-category-filter" class="icon-category-filter" role="group" aria-label="Font Awesome カテゴリーフィルター">
                                    <!-- Font Awesome カテゴリーボタンはJSで動的に生成されます -->
                                </div>
                                <div id="fa-icon-list-container" class="icon-list-container" aria-live="polite">
                                    <!-- Font Awesome アイコンはここにJavaScriptで描画されます -->
                                </div>
                            </section>

                            <!-- Material Icons Section -->
                            <section id="material-icons-section" class="icon-section" style="display: none;" aria-labelledby="mi-toggle-btn">
                                <div id="mi-icon-search-toolbar" class="icon-search-toolbar">
                                    <input type="text" id="mi-icon-search-input" placeholder="Material Icons検索..." aria-label="Material Icons検索">
                                </div>
                                <div class="icon-style-selector">
                                    <label for="mi-style-select">スタイル</label>
                                    <select id="mi-style-select">
                                        <option value="material-icons">Filled</option>
                                        <option value="material-icons-outlined">Outlined</option>
                                        <option value="material-icons-round">Round</option>
                                        <option value="material-icons-sharp">Sharp</option>
                                        <option value="material-icons-two-tone">Two Tone</option>
                                    </select>
                                </div>
                                <div id="mi-icon-category-filter" class="icon-category-filter" role="group" aria-label="Material Icons カテゴリーフィルター">
                                    <!-- Material Icons カテゴリーボタンはJSで動的に生成されます -->
                                </div>
                                <div id="mi-icon-list-container" class="icon-list-container" aria-live="polite">
                                    <!-- Material Icons はここにJavaScriptで描画されます -->
                                </div>
                            </section>
                        </div>
                        <div id="inspector-panel" class="sidebar-tab-content" data-tab-content="inspector" role="tabpanel" aria-labelledby="inspector-tab">
                             <div id="inspector"></div> <!-- 旧インスペクターのコンテナ -->
                             <div id="no-selection-message" class="no-selection-message-style">要素が選択されていません</div>
                        </div>
                        <div id="chat-panel-content" class="sidebar-tab-content" data-tab-content="chat" role="tabpanel" aria-labelledby="chat-tab">
                            <div id="chat-panel"> <!-- 旧チャットパネルのコンテナ -->
                                <div id="chat-messages" class="chat-messages-container" aria-live="polite"></div>
                                <div class="chat-input-area">
                                    <input type="text" id="chat-input" class="chat-input-field" placeholder="AIに質問..." aria-label="AIへの質問入力">
                                    <button id="send-chat-btn" class="send-chat-button">送信</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </aside>
                <main id="main-canvas-area" class="main-canvas-area-container" aria-label="スライド編集エリア">
                    <div id="slide-wrapper"> <!-- slide-wrapperのスタイルは既存のmain-pane内のものとほぼ同じはず -->
                        <div id="slide-canvas" role="region" aria-label="現在のスライド"></div>
                    </div>
                </main>
            </div>
            <footer id="bottom-pane" class="bottom-pane-container">
                <ul id="slide-list" class="slide-list-container" role="listbox" aria-label="スライド一覧"></ul>
            </footer>
        </div>
    </div>

    <div id="presentation-view" aria-hidden="true">
        <div id="presentation-slide-container"></div>
    </div>

    <!-- グラフ作成用モーダル -->
    <div class="modal micromodal-slide" id="chart-modal" aria-hidden="true">
      <div class="modal__overlay" tabindex="-1" data-micromodal-close>
        <div class="modal__container" role="dialog" aria-modal="true" aria-labelledby="chart-modal-title">
          <header class="modal__header">
            <h2 class="modal__title" id="chart-modal-title">グラフ作成</h2>
            <button class="modal__close" aria-label="Close modal" data-micromodal-close></button>
          </header>
          <main class="modal__content" id="chart-modal-content">
            <form id="chart-create-form">
              <div class="form-group">
                <label>グラフ種類</label>
                <select id="chart-type" required>
                  <option value="bar">棒グラフ</option>
                  <option value="line">折れ線グラフ</option>
                  <option value="pie">円グラフ</option>
                  <option value="doughnut">ドーナツグラフ</option>
                </select>
              </div>
              <div class="form-group">
                <label>ラベル（カンマ区切り）</label>
                <input type="text" id="chart-labels" value="A,B,C" required>
              </div>
              <div class="form-group">
                <label>データセット名</label>
                <input type="text" id="chart-dataset-label" value="Dataset" required>
              </div>
              <div class="form-group">
                <label>値（カンマ区切り）</label>
                <input type="text" id="chart-data" value="10,20,30" required>
              </div>
              <div class="form-group">
                <label>色（カンマ区切り, 空欄で自動）</label>
                <input type="text" id="chart-colors" placeholder="#007bff,#28a745,#dc3545">
              </div>
              <button type="submit" class="modal__btn modal__btn-primary">グラフを作成</button>
            </form>
          </main>
        </div>
      </div>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- QRコード生成用ライブラリ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <!-- Fuse.js を読み込み：アイコンあいまい検索用 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.6.2/fuse.min.js"></script>
    <link rel="stylesheet" href="mainmodal.css">
    <script src="https://cdn.jsdelivr.net/npm/micromodal@0.6.1/dist/micromodal.min.js"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
    <script src="app.js" defer></script>
</body>

</html>
